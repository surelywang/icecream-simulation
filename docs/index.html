<!DOCTYPE html>
<html>
<head>
	<title>CS 184 | Ice Cream Simulator</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700,800|Playfair+Display:400,700" rel="stylesheet">
	<meta charset="UTF-8">
</head>

<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>

<body>
	<div class="padded top">
		<h1 class="top">Ice Cream Simulator</h1>
		<p class="top"><b>CS 184 Final Project</b>  |  Shirley Wang, Lauren Martini, Natalie Khamphanh</p>
	</div>


    <div class="nav">
    	<center><ul>
      	 <li class="home"><a href="index.html"> Home </a></li>
		 <li class="milestone"><a href="milestone.html"> Milestone </a></li>
		 <li class="presentation"><a href="presentation.html"> Presentation </a></li>
		 <li class="video"><a href="video.html"> Video </a></li>
      </ul></center>
    </div>

	<div class="padded">
		<br>
		<h2>Abstract</h2>
		<h4>Our Proposal</h4>
		<p>Our team desired to create an ice cream melting simulator that incorporated concepts from this course.  We utilized THREE.js and WebGL to construct our simulator.  We built upon basic vertex manipulation techniques to simulate a melting scoop while default metaballs were transformed to create drops.  Texture mapping was used to add dimension and more realism to the ice cream simulated.  Lastly, we built a GUI that would allow for users to manipulate the texture and melting speed of our ice cream.</p>

		<br>

		<h2>Technical Approach</h2>
		<h4>Background</h4>
		<p>We strove to create this simulator as there are not many ice cream simulators and we wanted to see if it was possible.  Also the concept of a melting simulator really appealed to us as a group.</p>

		<p>When starting out, we did a lot of research on the chemistry of ice cream, particle simulations, and melting techinques used in graphics.</p>

		<p>Chemistry of Ice Cream:</p>
		<img src="images/Ice-Cream-Chemistry.png"/>

		<p><a href="https://sites.psu.edu/siowfa15/2015/09/18/does-the-flavor-of-ice-cream-affect-the-time-it-takes-to-melt/"></a>Flavor of Ice Cream Effect on Melting Rate</p>
		
		<p><a href="https://www.sciencedirect.com/science/article/pii/S0022030204731355"></a>Ice Cream Structural Elements that Affect Melting Rate and Hardness</p>

		<p>Melting Concepts and Guides:</p>

		<p><a href="https://drive.google.com/file/d/11b4j2SbBc9pBCd87enbFUKcAajMG0Ker/view"></a>Melting and Flowing</p>

		<p><a href="https://hal.archives-ouvertes.fr/hal-01549291/document"></a>Numerical Model of Melting, Liquid Migration and Deformation</p>
		
		<h4>Implementation</h4>
		<p>Our goal was to cleanly simulate a solid ice cream melting as there are not a ton of realistic ice cream simulators.  We decided to use Javascript and WebGL to push us out of our comfort zones.</p>

		<p>Our original idea for creating an ice cream simulator was to implement mesh to particle and particle to mesh again after each time step of particle manipulation.  In addition, we planned to incorporate the actual chemistry and food science of ice cream and how it melts under different conditions.  We also wanted to add extra toppings and types of ice cream that would react in their own ways to the temperature in the scene.  This proved to be too intensive for the scope and time deadline of the class and we thus decided to scale back a bit.</p>
		<p>
		After feedback from the TAs, we decided to focus on just the melting effect.  Instead of mesh to particle and back, using OpenGL and C++, we switched to particles and mesh manipulation in WebGL and THREE.js.
		</p>

		<p>
		On our first pass, we got textures mapped to the ice cream sphere and cone and were able to apply a displacement map to both as well.  We also got a simple simulation of particles dripping from the ice cream.
		</p>

		<p>
		Moving on from there, we looked into both vertex and shader deformation, settling on a vertex manipulation approach.  For the drops, we discovered metadrops are a really great way simulate the liquid motion we were looking for.  For a nice final touch, we added a gui that would allow the user to switch ice cream flavors and speed of the ice cream drops.
		</p>

		<h4>Vertex Manipulation</h4>
		<p>INSERT GIF OR VIDEO</p>

		<p></p>

		<h4>Metaballs</h4>
		<img src="images/repeatingDrop.gif"/>
		<p>
		Metaballs are created in THREE.js using MarchingCubes.js.  Metaballs are organic spheres that interact when close to each other by combining together fluidly.  The spheres used to make them are changed in opacity overtime to simulate the sphere changing in shape and space.  And the Marching Cubes algorithm was originally created in 1987 by Lorensen and Cline to create a mesh from an isosurface.
		</p>

		<p>Three dimensional metaballs formula (from Wikipedia):</p>
		<img src="images/metaballFormula.JPEG"/>

		<p>The above is expenisve to compute but the most common one used to create metaballs.</p>

		<p>The basic structure of metaballs had the right liquidly look for ice cream drops.  However, they do not act like dropping liquid by default.  There is no tracking of the previous y to calculate the new position which is what is needed to create the drops we were looking for.</p>

		<p>Thus some work needed to be done to transform the standard metaballs to ice cream drops.  We changed the sinusoidal functions to update x, y, and z to be one that calculated the new y position from the former based on time.  We created previous arrays to store the x, y, and z values for each blob or drop in the metaball.  At start, these array were intialized to default values for x, y, and z.  With drops, x was generated randomly using Math.random() to ensure they were spread out across the cone more organically.  The z position never changed and could stay at zero.  Y was the most important coordinate to update and started out at 1, which was the upper bound of the metaball effect generator.</p>

		<p>Each update step after the first, y was updated by a random value between 0 and 0.5 multiplied by time.  If y was below 0, it was just -0.5 * time to create a melting effect along the ground plane of the simulator.</p>

		<h4>GUI</h4>
		<p>INSERT GIF OR VIDEO</p>

		<p></p>

		<h4>Problems and Solutions</h4>
		<p>Getting the drops to match the ice cream scoop.</p>
		<p>Getting the drips to correctly fall: a major rehaul in calculation of metaball creation and updating had to be done to get the correct look.  To get them to move correctly, we had to create arrays of previous locations that would be updated in each pass so that the next time step would be based on the previous and the next one on that step and so on.  Also, figuring out how to calculate the x position to spread nicely across the top of the metaball effect frame instead of just quickly flashing back and forth.</p>

		<h4>Lessons Learned</h4>
		<p>Some text goes here.</p>

		<br>

		<h2>Results</h2>
		<h4>Subtitle here</h4>
		<p>Some text goes here.</p>

		<br>

		<h2>References</h2>
		<h4>Inspiration</h4>
		<p><a href="https://www.youtube.com/watch?v=bnH_wiaF4sQ"></a>Time Lapse of Melting Ice Cream</p>
		
		<h4>Early Style Influence</h4>
		<p><a href="https://peeke.nl/simulating-blobs-of-fluid"></a>Simulating Blobs of Fluid by Peeke Kuepers</p>

		<h4>Vertex Manipulation</h4>
		<p><a href="https://peeke.nl/simulating-blobs-of-fluid"></a>CHANGE LINK</p>

		<h4>Metaballs</h4>
		<p><a href="https://github.com/mrdoob/three.js/blob/dev/examples/webgl_marchingcubes.html"></a>Marching Cubes Example by mrdoob</p>

		<h4>Gui</h4>
		<p><a href="https://github.com/dataarts/dat.gui"></a>Dat Gui GitHub</p>

		<h4>Scientific Papers</h4>
		<p><a href="https://graphics.stanford.edu/courses/cs348c-95-fall/projects/redkey_herman/writeup.html"></a>Particle Melting Inspiration</p>

		<p><a href="https://pdfs.semanticscholar.org/d92f/735b0773b4e697e7e72798eccae2f647acd6.pdf"></a>Marching Cubes Background</p>

		<p><a href="https://peeke.nl/simulating-blobs-of-fluid"></a>CHANGE LINK</p>

		<h4>Ice Cream Textures and Graphics</h4>
		<p><a href="https://www.compoundchem.com/2015/07/14/ice-cream/"></a>Chemistry of Ice Cream Infographic</p>
		<p><a href="https://creativecommons.org/licenses/by-nc/3.0/us/"></a>Creative Commons License for Chemistry of Ice Cream Infographic</p>
		
		<p>Natalie's Tumblr????</p>

		<p>Kisspng.com</p>

		<br>

		<h2>Team Contribution</h2>
		<h4>Shirley Wang</h4>
		<p>Some text goes here.</p>

		<h4>Lauren Martini</h4>
		<p>Up to the milestone, I worked on trying to get vertex manipulation to work but it ended up pulling down the whole sphere instead of just vertices.</p>

		<p>Moving on from that, my main contribution was transforming metaballs from their default form in THREE.js to a drip effect.  I started with the MarchingCubes.js made by mrdoob and manipulated the metaballs generated from that to create dripping ice cream.</p>

		<h4>Natalie Khamphanah</h4>
		<p>Some text goes here.</p>

	</div>
</body>
</html>
